---
layout: article
title: 我的第一篇博客
date: 2024-09-04
category: CTF
---

python脚本  快速计算网页50道计算题

```python
import requests
from bs4 import BeautifulSoup
import time


# 爬取网页内容的函数
def fetch_webpage(url, session):
    try:
        response = session.get(url)
        response.raise_for_status()  # 检查请求是否成功
        return response.text
    except requests.RequestException as e:
        print(f"Error fetching {url}: {e}")
        return None


# 发送POST请求的函数//这两本质一样的。
def send_post_request(url, data, session):
    try:
        response = session.post(url, data=data)
        response.raise_for_status()  # 检查请求是否成功
        return response.text
    except requests.RequestException as e:
        print(f"Error posting to {url}: {e}")
        return None


# 主函数
def main():
    # 要爬取的网页URL
    fetch_url = 'http://challenge.basectf.fun:36513/'
    # 要发送POST请求的URL
    post_url = 'http://challenge.basectf.fun:36513/'

    # 示例Cookie值（根据实际情况修改）
    cookies = {
        'PHPSESSID': 'jc0o43u332d9d4106e4i3q20r9',
        'userid': 'your-user-id',
        'token': 'your-token'
    }

    # 创建一个会话
    session = requests.Session()
    session.cookies.update(cookies)
    webpage_content = fetch_webpage(fetch_url, session)
    # 执行50次循环
    for i in range(50):
        print(f"Attempt {i + 1}")
        print(webpage_content)

        # 找到算术问题
        text1 = webpage_content.split("second ")
        if len(text1) > 1:
            text2 = text1[1].split("?")
            if text2:
                problem = text2[0]
                print(problem)

                # 计算答案
                answer = None
                if '+' in problem:
                    operands = problem.split("+")
                    answer = eval(operands[0]) + eval(operands[1])
                elif '-' in problem:
                    operands = problem.split("-")
                    answer = eval(operands[0]) - eval(operands[1])
                elif '×' in problem:
                    operands = problem.split("×")
                    answer = eval(operands[0]) * eval(operands[1])
                elif '÷' in problem:
                    operands = problem.split("÷")
                    answer = eval(operands[0]) // eval(operands[1])  # 注意除法取整用 //

                if answer is not None:
                    print(f"Answer: {answer}")

                    # 发送计算结果
                    post_data = {'answer': answer}
                    webpage_content = send_post_request(post_url, post_data, session)
                    if webpage_content:
                        print(f"POST Response after calculation: {webpage_content}")
                else:
                    print("No valid operation found in the string")
            else:
                print("Failed to split the text to get the problem")
        else:
            print("Failed to split the response text")

        # 每次请求之间等待5秒
        time.sleep(0.1)


if __name__ == '__main__':
    main()
```
<div style="text-align: center;">
    <img src="/assets/images/2.png" alt="描述" width="600" height="300" />
    <img src="/assets/images/3.png" alt="描述" width="600" height="400" />
</div>

